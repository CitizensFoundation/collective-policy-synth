{"version":3,"file":"ps-edit-node-dialog.js","sourceRoot":"","sources":["../../src/operations/ps-edit-node-dialog.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html, css } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\n\nimport '@material/web/dialog/dialog.js';\nimport '@material/web/button/text-button.js';\nimport '@material/web/button/filled-button.js';\nimport '@yrpri/webapp/yp-survey/yp-structured-question-edit.js';\nimport { YpBaseElement } from '@yrpri/webapp/common/yp-base-element';\n\n@customElement('ps-edit-node-dialog')\nexport class PsEditNodeDialog extends YpBaseElement {\n  @property({ type: Boolean }) open = false;\n  @property({ type: Object }) nodeToEditInfo: any;\n\n  disableScrim(event: CustomEvent) {\n    event.stopPropagation();\n    event.preventDefault();\n  }\n\n  render() {\n    return html`\n      <md-dialog ?open=\"${this.open}\" @closed=\"${this._handleClose}\" @cancel=\"${this.disableScrim}\">\n        <div slot=\"headline\">\n          ${this.nodeToEditInfo ? this._renderNodeEditHeadline() : ''}\n        </div>\n        <div slot=\"content\">\n          ${this.nodeToEditInfo ? this._renderEditForm() : ''}\n        </div>\n        <div slot=\"actions\">\n          <md-text-button @click=\"${this._handleClose}\">Cancel</md-text-button>\n          <md-filled-button @click=\"${this._handleSave}\">Save</md-filled-button>\n        </div>\n      </md-dialog>\n    `;\n  }\n\n  _renderNodeEditHeadline() {\n    return html`\n      <div class=\"layout horizontal\">\n        <div>\n          <img\n            src=\"${this.nodeToEditInfo.Class.configuration.imageUrl}\"\n            class=\"nodeEditHeadlineImage\"\n          />\n        </div>\n        <div class=\"nodeEditHeadlineTitle\">\n          ${this.nodeToEditInfo.Class.name}\n        </div>\n      </div>\n    `;\n  }\n\n  _renderEditForm() {\n    return html`\n      <div id=\"surveyContainer\">\n        ${this.nodeToEditInfo.Class.configuration.questions.map(\n          (question: YpStructuredQuestionData, index: number) => html`\n            <yp-structured-question-edit\n              index=\"${index}\"\n              id=\"structuredQuestion_${question.uniqueId\n                ? index\n                : `noId_${index}`}\"\n              .structuredAnswers=\"${this._getInitialAnswers()}\"\n              .question=\"${question}\"\n            >\n            </yp-structured-question-edit>\n          `\n        )}\n      </div>\n    `;\n  }\n\n  _getInitialAnswers() {\n    return Object.entries(this.nodeToEditInfo.configuration).map(\n      ([key, value]) => ({\n        uniqueId: key,\n        value: value,\n      })\n    );\n  }\n\n  _handleClose() {\n    this.dispatchEvent(new CustomEvent('close'));\n  }\n\n  _handleSave() {\n    const updatedConfig = {} as Record<string, any>;\n    this.nodeToEditInfo.Class.configuration.questions.forEach(\n      (question: YpStructuredQuestionData, index: number) => {\n        const questionElement = this.shadowRoot?.querySelector(\n          `#structuredQuestion_${question.uniqueId ? index : `noId_${index}`}`\n        ) as any;\n        if (questionElement && question.uniqueId) {\n          const answer = questionElement.getAnswer();\n          if (answer) {\n            updatedConfig[question.uniqueId] = answer.value;\n          }\n        }\n      }\n    );\n\n    this.dispatchEvent(new CustomEvent('save', { detail: { updatedConfig } }));\n    this._handleClose();\n  }\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        .nodeEditHeadlineImage {\n          max-width: 100px;\n          margin-right: 16px;\n        }\n\n        .nodeEditHeadlineTitle {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          height: 55px;\n        }\n\n        md-dialog {\n          width: 90%;\n          height: 90%;\n        }\n      `,\n    ];\n  }\n}\n"]}