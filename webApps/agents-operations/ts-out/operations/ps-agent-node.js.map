{"version":3,"file":"ps-agent-node.js","sourceRoot":"","sources":["../../src/operations/ps-agent-node.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, html, nothing } from 'lit';\nimport { property, customElement } from 'lit/decorators.js';\n\nimport '@material/web/iconbutton/icon-button.js';\nimport '@material/web/progress/circular-progress.js';\nimport '@material/web/menu/menu.js';\nimport '@material/web/menu/menu-item.js';\n\nimport { OpsServerApi } from './OpsServerApi.js';\nimport { PsOperationsView } from './ps-operations-view.js';\nimport { MdMenu } from '@material/web/menu/menu.js';\nimport { YpBaseElement } from '@yrpri/webapp/common/yp-base-element.js';\nimport { PsOperationsBaseNode } from './ps-operations-base-node.js';\n\n@customElement('ps-agent-node')\nexport abstract class PsAgentNode extends PsOperationsBaseNode {\n  @property({ type: Object })\n  agent!: PsAgentInstance;\n\n  @property({ type: Number })\n  agentId!: number;\n\n  @property({ type: Boolean })\n  isWorking = false;\n\n  api: OpsServerApi;\n\n  constructor() {\n    super();\n    this.api = new OpsServerApi();\n  }\n\n  connectedCallback(): void {\n    super.connectedCallback();\n    this.agent = window.psAppGlobals.getAgentInstance(this.agentId);\n  }\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        .image {\n          width: 200px;\n          height: 113px;\n          border-radius: 16px 16px 0 0;\n        }\n\n        .agentClassName {\n          height: 100%;\n          font-size: 16px;\n          padding: 8px;\n          text-align: center;\n          align-items: center;\n        }\n\n        .agentName {\n          height: 80px;\n          font-size: 14px;\n          padding: 8px;\n          padding-top: 0;\n          text-align: center;\n          align-items: center;\n        }\n\n        .mainContainer {\n          height: 100%;\n          border-radius: 16px;\n        }\n\n        .createOptionsButtons {\n          display: flex;\n          justify-content: center;\n          position: absolute;\n          bottom: 0;\n          left: 0;\n          right: 0;\n          padding-left: 8px;\n          padding-right: 8px;\n        }\n\n        .createOptionsButtons[root-cause] {\n        }\n\n        .editButton {\n          position: absolute;\n          bottom: -6px;\n          right: 0;\n          z-index: 1500;\n        }\n\n        .checklistButton {\n          position: absolute;\n          bottom: -6px;\n          left: 0;\n          z-index: 1500;\n        }\n\n        .typeIconCore {\n          position: absolute;\n          bottom: 8px;\n          left: 8px;\n        }\n\n        .typeIcon {\n          color: var(--md-sys-color-primary);\n        }\n\n        .typeIconUde {\n          color: var(--md-sys-color-tertiary);\n        }\n\n        .typeIconRoot {\n          color: var(--md-sys-color-on-primary);\n        }\n\n        md-icon-button[root-cause] {\n          --md-icon-button-icon-color: var(--md-sys-color-on-primary);\n        }\n\n        md-circular-progress {\n          --md-circular-progress-size: 28px;\n          margin-bottom: 6px;\n        }\n\n        md-menu {\n          --md-menu-z-index: 1000;\n          z-index: 1000;\n        }\n\n        [hidden] {\n          display: none !important;\n        }\n      `,\n    ];\n  }\n\n  async createDirectCauses() {\n    const nodes = await this.api.createDirectCauses(this.agent.id, this.nodeId);\n\n    this.fireGlobal('add-nodes', {\n      parentNodeId: this.nodeId,\n      nodes,\n    });\n  }\n\n  editNode() {\n    this.fire('edit-node', {\n      nodeId: this.nodeId,\n      element: this.agent,\n    });\n  }\n\n  toggleMenu() {\n    const menu = this.shadowRoot?.getElementById('menu') as MdMenu;\n    menu.open = !menu.open;\n  }\n\n  renderImage() {\n    return html`\n      <div class=\"layout horizontal center-center\">\n        <img class=\"image\" src=\"${this.agent.class.imageUrl}\" />\n      </div>\n    `;\n  }\n\n  clickPlayPause() {\n    if (this.agent.id == this.currentRunningAgentId) {\n      this.fireGlobal('pause-agent', {\n        agentId: this.agent.id,\n      });\n      window.psAppGlobals.setCurrentRunningAgentId(undefined);\n    } else {\n      this.fireGlobal('run-agent', {\n        agentId: this.agent.id,\n      });\n      window.psAppGlobals.setCurrentRunningAgentId(this.agent.id);\n    }\n    this.requestUpdate();\n  }\n\n  override render() {\n    if (this.agent) {\n      if (this.agent.id == this.currentRunningAgentId) {\n        this.parentElement.className = \"agentContainer agentContainerRunning\";\n      } else {\n        this.parentElement.className = \"agentContainer\";\n      }\n      return html`\n        <div class=\"layout vertical mainContainer\">\n          ${this.renderImage()}\n          <div class=\"agentClassName\">${this.agent.class.name}</div>\n          <div class=\"agentName\">${this.agent.configuration['name']}</div>\n\n          <md-icon-button class=\"checklistButton\">\n            <md-icon>checklist</md-icon></md-icon-button\n          >\n\n          <md-icon-button class=\"editButton\" @click=\"${this.editNode}\"\n            ><md-icon>settings</md-icon></md-icon-button\n          >\n\n          <div class=\"layout horizontal center-justify createOptionsButtons\">\n            ${this.isWorking\n              ? html`\n                  <md-circular-progress indeterminate></md-circular-progress>\n                `\n              : html`\n                  <md-outlined-icon-button\n                    class=\"createOptionsButton\"\n                    ?disabled=\"${window.psAppGlobals.currentRunningAgentId &&\n                    this.agent.id != window.psAppGlobals.currentRunningAgentId}\"\n                    @click=\"${this.clickPlayPause}\"\n                    ><md-icon\n                      >${this.agent.id ==\n                      window.psAppGlobals.currentRunningAgentId\n                        ? `pause`\n                        : `play_arrow`}</md-icon\n                    ></md-outlined-icon-button\n                  >\n                `}\n          </div>\n        </div>\n      `;\n    } else {\n      return nothing;\n    }\n  }\n}\n"]}