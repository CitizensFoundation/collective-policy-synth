{"version":3,"file":"ps-connector-shape.js","sourceRoot":"","sources":["../../src/operations/ps-connector-shape.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,EAAE,MAAM,aAAa,CAAC;AAEnD,MAAM,OAAO,kBAAmB,SAAQ,GAAG,CAAC,WAAW;IACrD,MAAM;QACJ,KAAK,CAAC,MAAM,EAAE,CAAC;QAEf,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAE5C,IAAI,kBAAkB,GAAG,EAAE,CAAC;QAC5B,IAAI,mBAAmB,GAAG,EAAE,CAAC;QAE7B,mDAAmD;QACnD,MAAM,aAAa,GAAG,CAAC,CAAC,eAAe,EAAE;YACvC,KAAK,EAAE,kBAAkB;YACzB,MAAM,EAAE,mBAAmB;YAC3B,KAAK,EAAE,oCAAoC;SAC5C,CAAC,CAAC,IAAI,CAAC;QAER,sCAAsC;QACtC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;QAEjC,4DAA4D;QAC5D,UAAU,CAAC,GAAG,EAAE;YACd,MAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC1C,GAAG,CAAC,YAAY,CAAC,OAAO,EAAE,cAAc,CAAC,CAAC;YAC1C,GAAG,CAAC,YAAY,CAAC,OAAO,EAAE,8BAA8B,CAAC,CAAC;YAE1D,GAAG,CAAC,SAAS,GAAG;mBACH,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,OAAO;;2BAErB,CAAC;YAEtB,sCAAsC;YACtC,aAAa,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;YAE/B,yCAAyC;YACzC,aAAa,CAAC,qBAAqB,EAAE,CAAC;QACxC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,yFAAyF;QAEhG,IAAI,CAAC,MAAM,EAAE,CAAC;QACd,OAAO,IAAI,CAAC;IACd,CAAC;CACF;AAED,MAAM,OAAO,cAAe,SAAQ,MAAM,CAAC,QAAQ,CAAC,SAAS;IAA7D;;QAYE,SAAI,GAAG,kBAAkB,CAAC;IAC5B,CAAC;IAZC,QAAQ;QACN,OAAO,IAAI,CAAC,cAAc,CACxB;YACE,IAAI,EAAE,qBAAqB;YAC3B,KAAK,EAAE,EAAE;YACT,MAAM,EAAE,aAAa;SACtB,EACD,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,QAAQ,CAC7C,CAAC;IACJ,CAAC;CAGF","sourcesContent":["import { dia, shapes, util, V } from '@joint/core';\n\nexport class ConnectorShapeView extends dia.ElementView {\n  render() {\n    super.render();\n\n    const htmlMarkup = this.model.get('markup');\n\n    let foreignObjectWidth = 90;\n    let foreignObjectHeight = 40;\n\n    // Create a foreignObject with a set size and style\n    const foreignObject = V('foreignObject', {\n      width: foreignObjectWidth,\n      height: foreignObjectHeight,\n      style: 'overflow: visible; display: block;',\n    }).node;\n\n    // Append the foreignObject to this.el\n    V(this.el).append(foreignObject);\n\n    // Defer the addition of the inner div with the HTML content\n    setTimeout(() => {\n      const div = document.createElement('div');\n      div.setAttribute('class', 'html-element');\n      div.setAttribute('xmlns', 'http://www.w3.org/1999/xhtml');\n\n      div.innerHTML = `<ps-connector-node\n        agentId=\"${this.model.attributes.agentId}\"\n        >\n      </ps-connector-node>`;\n\n      // Append the div to the foreignObject\n      foreignObject.appendChild(div);\n\n      // Force layout recalculation and repaint\n      foreignObject.getBoundingClientRect();\n    }, 0); // A timeout of 0 ms defers the execution until the browser has finished other processing\n\n    this.update();\n    return this;\n  }\n}\n\nexport class ConnectorShape extends shapes.standard.Rectangle {\n  defaults() {\n    return util.deepSupplement(\n      {\n        type: 'html.ConnectorShape',\n        attrs: {},\n        markup: '<div></div>',\n      },\n      shapes.standard.Rectangle.prototype.defaults\n    );\n  }\n\n  view = ConnectorShapeView;\n}\n"]}