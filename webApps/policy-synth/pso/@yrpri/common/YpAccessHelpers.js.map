{"version":3,"file":"YpAccessHelpers.js","sourceRoot":"","sources":["../../../src/@yrpri/common/YpAccessHelpers.ts"],"names":[],"mappings":"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","sourcesContent":["export class YpAccessHelpers {\n  static _hasAdminRights(\n    objectId: number,\n    adminRights: Array<YpCollectionData>\n  ): boolean {\n    return (\n      adminRights.find((o: YpCollectionData) => {\n        return o.id == objectId;\n      }) != null\n    );\n  }\n\n  static _hasAccess(\n    object: YpCollectionData | YpImageData | YpPointData | YpPostData,\n    objectId: number,\n    adminRights: Array<YpCollectionData>\n  ): boolean {\n    if (object) {\n      if (window.appUser && window.appUser.user) {\n        if (window.appUser.user.id == object.user_id) {\n          return true;\n        } else if (object.User && window.appUser.user.id == object.User.id) {\n          return true;\n        } else {\n          if (window.appUser.adminRights) {\n            return this._hasAdminRights(objectId, adminRights);\n          } else {\n            return false;\n          }\n        }\n      } else {\n        return false;\n      }\n    } else if (!window.appUser) {\n      return false;\n    } else {\n      console.warn('No object in hasAccess');\n      return false;\n    }\n  }\n\n  static hasImageAccess(image: YpImageData, post: YpPostData): boolean {\n    if (image && post && window.appUser && window.appUser.adminRights) {\n      return this._hasAccess(\n        image,\n        post.group_id,\n        window.appUser.adminRights.GroupAdmins\n      );\n    } else {\n      return false;\n    }\n  }\n\n  static checkPostAccess(post: YpPostData): boolean {\n    if (post && window.appUser && window.appUser.adminRights) {\n      return this._hasAccess(\n        post,\n        post.group_id,\n        window.appUser.adminRights.GroupAdmins\n      );\n    }\n    if (post && post.User && window.appUser && window.appUser.user) {\n      return post.User.id === window.appUser.user.id;\n    } else if (!post) {\n      console.warn('No post in hasAccess');\n      return false;\n    } else {\n      return false;\n    }\n  }\n\n  static checkPointAccess(point: YpPointData): boolean {\n    if (point && point.Post && window.appUser && window.appUser.adminRights) {\n      return this._hasAccess(\n        point,\n        point.Post.group_id,\n        window.appUser.adminRights.GroupAdmins\n      );\n    } else if (\n      point &&\n      window.appUser &&\n      window.appUser.user &&\n      window.appUser.user.id == point.user_id\n    ) {\n      return true;\n    } else if (point) {\n      return false;\n    } else {\n      //console.warn(\"No point in hasAccess\");\n      return false;\n    }\n  }\n\n  static checkPostAdminOnlyAccess(post: YpPostData): boolean {\n    if (post && window.appUser && window.appUser.adminRights) {\n      return this._hasAdminRights(\n        post.group_id,\n        window.appUser.adminRights.GroupAdmins\n      );\n    } else if (post) {\n      return false;\n    } else {\n      console.warn('No post in hasAccess');\n      return false;\n    }\n  }\n\n  static checkGroupAccess(group: YpGroupData): boolean {\n    if (group && window.appUser && window.appUser.adminRights) {\n      return this._hasAccess(\n        group,\n        group.id,\n        window.appUser.adminRights.GroupAdmins\n      );\n    } else if (group) {\n      return false;\n    } else {\n      console.warn('No group in hasAccess');\n      return false;\n    }\n  }\n\n  static checkCommunityAccess(community: YpCommunityData): boolean {\n    if (community && window.appUser && window.appUser.adminRights) {\n      return this._hasAccess(\n        community,\n        community.id,\n        window.appUser.adminRights.CommunityAdmins\n      );\n    } else if (community) {\n      return false;\n    } else {\n      console.warn('No community in hasAccess');\n      return false;\n    }\n  }\n\n  static checkDomainAccess(domain: YpDomainData): boolean {\n    if (domain && window.appUser && window.appUser.adminRights) {\n      return this._hasAccess(\n        domain,\n        domain.id,\n        window.appUser.adminRights.DomainAdmins\n      );\n    } else if (domain) {\n      return false;\n    } else {\n      console.warn('No domain in hasAccess');\n      return false;\n    }\n  }\n\n  static hasUserAccess(user: YpUserData): boolean {\n    if (\n      user &&\n      window.appUser &&\n      window.appUser.user &&\n      window.appUser.user.id == user.id\n    ) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n"]}