{"version":3,"file":"ac-activity.js","sourceRoot":"","sources":["../../../src/@yrpri/ac-activities/ac-activity.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, css, nothing } from 'lit';\nimport { property, customElement } from 'lit/decorators.js';\n\nimport { DateTime } from 'luxon';\n\nimport './ac-activity-point.js';\nimport './ac-activity-post.js';\nimport './ac-activity-point-news-story.js';\nimport './ac-activity-post-status-update.js';\nimport '../yp-user/yp-user-with-organization.js';\nimport '@material/web/button/outlined-button.js';\n\nimport { YpBaseElementWithLogin } from '../common/yp-base-element-with-login.js';\n\nimport { YpAccessHelpers } from '../common/YpAccessHelpers.js';\n\nimport { ShadowStyles } from '../common/ShadowStyles.js';\n\n@customElement('ac-activity')\nexport class AcActivity extends YpBaseElementWithLogin {\n  @property({ type: Object })\n  activity: AcActivityData | undefined;\n\n  @property({ type: Number })\n  domainId: number | undefined;\n\n  @property({ type: Number })\n  communityId: number | undefined;\n\n  @property({ type: Number })\n  groupId: number | undefined;\n\n  @property({ type: Number })\n  postId: number | undefined;\n\n  @property({ type: Number })\n  postGroupId: number | undefined;\n\n  @property({ type: Number })\n  userId: number | undefined;\n\n  static get styles() {\n    return [\n      super.styles,\n      ShadowStyles,\n      css`\n        .activity {\n          margin: 16px;\n          background-color: #fff;\n          height: 100%;\n          padding-left: 16px;\n          padding-right: 16px;\n          margin-bottom: 0;\n        }\n\n        @media (max-width: 600px) {\n          .activity {\n            width: 100%;\n            height: 100%;\n\n            margin: 0;\n            padding-left: 16px;\n            padding-right: 16px;\n            margin-bottom: 8px;\n            margin-top: 8px;\n            width: -webkit-calc(100% - 8px);\n            width: -moz-calc(100% - 8px);\n            width: calc(100% - 8px);\n          }\n\n          .activity[logged-in-user] {\n            margin-left: 0;\n            width: -webkit-calc(100% - 16px);\n            width: -moz-calc(100% - 16px);\n            width: calc(100% - 16px);\n          }\n        }\n\n        .aaaactivity[is-old-safari-or-ie] {\n          height: 550px;\n          overflow: auto;\n        }\n\n        .mainActivityContent {\n          height: 100% !important;\n        }\n\n        ac-activity-header {\n        }\n\n        ac-activity-post {\n          width: 100%;\n        }\n\n        .headerUserImage {\n          padding-top: 16px;\n        }\n\n        h1 {\n          font-size: 24px;\n        }\n\n        md-outlined-button {\n          color: var(--accent-color);\n        }\n\n        md-icon {\n          width: 48px;\n          height: 48px;\n          padding-top: 14px;\n        }\n\n        .createdAt {\n          color: #777;\n          margin-top: 16px;\n          font-size: 14px;\n        }\n\n        yp-ajax {\n          background-color: var(--primary-background-color);\n        }\n\n        .deleteIcon {\n          position: absolute;\n          right: 8px;\n          bottom: 8px;\n          color: #ddd;\n        }\n\n        [hidden] {\n          display: none !important;\n        }\n      `,\n    ];\n  }\n\n  renderActivity() {\n    switch (this.activity!.type) {\n      case 'activity.post.new':\n        return html`\n          <ac-activity-post\n            .activity=\"${this.activity}\"\n            .postId=\"${this.postId}\"\n            .communityId=\"${this.communityId}\"\n            .groupId=\"${this.groupId}\"></ac-activity-post>\n        `;\n      case 'activity.point.new':\n        return html`\n          <ac-activity-point\n            .postId=\"${this.postId}\"\n            .activity=\"${this.activity}\"></ac-activity-point>\n        `;\n      case 'activity.point.newsStory.new':\n        return html`\n          <ac-activity-point-news-story\n            .activity=\"${this.activity}\"\n            .postId=\"${this.postId}\"\n            .communityId=\"${this.communityId}\"\n            .groupId=\"${this.groupId}\"></ac-activity-point-news-story>\n        `;\n      case 'activity.post.status.change':\n        return html`\n          <ac-activity-post-status-update\n            .postId=\"${this.postId}\"\n            .activity=\"${this.activity}\"></ac-activity-post-status-update>\n        `;\n      default:\n        return nothing;\n    }\n  }\n\n  render() {\n    return this.activity\n      ? html`\n          <div\n            .loggedInUser=\"${this.isLoggedIn}\"\n            class=\"layout vertical activity\"\n            tabindex=\"${this.tabIndex}\">\n            <md-outlined-icon-button\n              .label=\"${this.t('deleteActivity')}\"\n              ?hidden=\"${!this.hasActivityAccess}\"\n              icon=\"delete\"\n              data-args=\"${this.activity.id}\"\n              class=\"deleteIcon\"\n              @click=\"${this._deleteActivity}\"></md-outlined-icon-button>\n            <div class=\"mainActivityContent\">\n              <div class=\"layout horizontal\">\n                <yp-user-with-organization\n                  .user=\"${this.activity.User}\"\n                  inverted></yp-user-with-organization>\n                <div class=\"flex\"></div>\n                <div\n                  ?hidden=\"${!this.wide}\"\n                  class=\"createdAt\"\n                  .title=\"${this.fromLongTime(this.activity.created_at)}\">\n                  ${this.fromTime(this.activity.created_at)}\n                </div>\n              </div>\n\n              ${this.renderActivity()}\n            </div>\n          </div>\n        `\n      : nothing;\n  }\n\n  fromTime(timeValue: string) {\n    return DateTime.fromISO(timeValue).toRelative();\n  }\n\n  fromLongTime(timeValue: string) {\n    return DateTime.fromISO(timeValue).toLocaleString(DateTime.DATETIME_FULL);\n  }\n\n  get hasActivityAccess() {\n    if (this.activity) {\n      if (this.domainId && this.activity.Domain) {\n        return YpAccessHelpers.checkDomainAccess(this.activity.Domain);\n      } else if (this.communityId && this.activity.Community) {\n        return YpAccessHelpers.checkCommunityAccess(this.activity.Community);\n      } else if (this.groupId && this.activity.Group) {\n        return YpAccessHelpers.checkGroupAccess(this.activity.Group);\n      } else if (this.postId && this.activity.Post) {\n        return YpAccessHelpers.checkPostAccess(this.activity.Post);\n      } else {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  }\n\n  _deleteActivity() {\n    this.fire('ak-delete-activity', { id: this.activity!.id });\n  }\n\n  _isNotActivityType(activity: AcActivityData, type: string) {\n    return activity.type != type;\n  }\n\n  _isActivityType(activity: AcActivityData, type: string) {\n    return activity.type == type;\n  }\n}\n"]}