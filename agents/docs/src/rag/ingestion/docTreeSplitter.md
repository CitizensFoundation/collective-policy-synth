# DocumentTreeSplitAgent

This class is responsible for splitting a document into manageable chunks based on a strategy generated by a language model. It extends the `BaseIngestionAgent` class.

## Properties

| Name                     | Type   | Description               |
|--------------------------|--------|---------------------------|
| maxSplitRetries          | number | Maximum number of retries for splitting the document. |
| minChunkCharacterLength  | number | Minimum number of characters a chunk must have. |
| maxChunkLinesLength      | number | Maximum number of lines a chunk can contain. |
| strategySystemMessage    | SystemMessage | Predefined system message for generating split strategy. |
| strategyUserMessage      | (data: string) => HumanMessage | Function to generate a user message for split strategy. |
| strategyWithReviewUserMessage | (data: string, lastAttempt: string, reviewComments: string) => HumanMessage | Function to generate a user message for reviewing split strategy. |
| reviewStrategySystemMessage | SystemMessage | Predefined system message for reviewing split strategy. |
| reviewStrategyUserMessage | (data: string, splitStrategy: string) => HumanMessage | Function to generate a user message for evaluating split strategy. |

## Methods

| Name                        | Parameters                                             | Return Type | Description |
|-----------------------------|--------------------------------------------------------|-------------|-------------|
| generateDiff                | str1: string, str2: string                             | string      | Generates a diff between two strings and provides context around the difference. |
| fetchLlmChunkingStrategy    | data: string, review: string \| undefined, lastJson: LlmDocumentChunksStrategy[] \| undefined | Promise<{ chunkingStrategy: string; chunkingStrategyReview: string; lastChunkingStrategyJson: LlmDocumentChunksStrategy[]; }> | Fetches chunking strategy from a language model. |
| aggregateChunkData          | chunks: LlmDocumentChunksStrategy[]                    | string      | Aggregates data from chunks and subchunks recursively. |
| normalizeLineBreaks         | text: string                                           | string      | Normalizes line breaks in the text. |
| splitDocumentIntoChunks     | data: string, isSubChunk: boolean = false, totalLinesInChunk?: number | Promise<LlmDocumentChunksStrategy[] \| undefined> | Splits the document into chunks based on the strategy from the language model. |

## Example

```typescript
import { DocumentTreeSplitAgent } from '@policysynth/agents/rag/ingestion/docTreeSplitter.js';

const agent = new DocumentTreeSplitAgent();

// Example usage of splitting a document
const documentData = "Your document data here...";
agent.splitDocumentIntoChunks(documentData).then(chunks => {
  console.log("Document chunks:", chunks);
});
```